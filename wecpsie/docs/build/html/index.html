

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Welcome to wecpsie’s documentation! &mdash; wecpsie 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> wecpsie
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to wecpsie’s documentation!</a></li>
<li><a class="reference internal" href="#module-src.st_crawler_wecpsie">Spider-Wecpsie crawler</a></li>
<li><a class="reference internal" href="#module-src.st_scraper_wecpsie">Extract-Wecpsie scraper</a></li>
<li><a class="reference internal" href="#module-src.st_wpse_db_connection">Store-Wecpsie database</a></li>
<li><a class="reference internal" href="#module-src.d_utilities">Utilities-Wecpsie</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">wecpsie</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Welcome to wecpsie’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-wecpsie-s-documentation">
<h1>Welcome to wecpsie’s documentation!<a class="headerlink" href="#welcome-to-wecpsie-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="module-src.st_crawler_wecpsie">
<span id="spider-wecpsie-crawler"></span><h1>Spider-Wecpsie crawler<a class="headerlink" href="#module-src.st_crawler_wecpsie" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="src.st_crawler_wecpsie.crawl_pcpsie_contrato_page">
<code class="sig-prename descclassname"><span class="pre">src.st_crawler_wecpsie.</span></code><code class="sig-name descname"><span class="pre">crawl_pcpsie_contrato_page</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pcrawler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_crawler_wecpsie.html#crawl_pcpsie_contrato_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_crawler_wecpsie.crawl_pcpsie_contrato_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigator for the information shown in page: Resumen Información Esencial del Contrato.</p>
<p>The function handles the navigation and scrapping for the table Información de Adjudicación.</p>
<p>pcrawler : webdriver instance to perform crawling operations.</p>
<p>Not all the Proceso de Contratación Pública Subasta Inversa Electronica (PCPSIE) published has this information page, it depens of the state of the process</p>
<p>This function does not depend on any user to make any input, since it retrieves the links for each page
directly from the database. The links to every PCPSIE page are saved to the database during the crawl_pcpsie_page
function.</p>
<p>Any error, warning encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crawl_pcpsie_contrato_page</span><span class="p">(</span><span class="n">pcrawler</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="src.st_crawler_wecpsie.crawl_pcpsie_invitacion_page">
<code class="sig-prename descclassname"><span class="pre">src.st_crawler_wecpsie.</span></code><code class="sig-name descname"><span class="pre">crawl_pcpsie_invitacion_page</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pcrawler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_crawler_wecpsie.html#crawl_pcpsie_invitacion_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_crawler_wecpsie.crawl_pcpsie_invitacion_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigator for the information shown in page: Invitaciones a proveedores.</p>
<p>The function handles the navigation and scrapping for the table Invitaciones a proveedores.</p>
<p>pcrawler : webdriver instance to perform crawling operations.</p>
<p>all the Proceso de Contratación Pública Subasta Inversa Electronica (PCPSIE) published has this information page, but
in some cases there are no invited companies</p>
<p>This function does not depend on any user to make any input, since it retrieves the links for each page
directly from the database. The links to every PCPSIE page are saved to the database during the crawl_pcpsie_page
function.</p>
<p>Any error, warning encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crawl_pcpsie_invitacion_page</span><span class="p">(</span><span class="n">pcrawler</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="src.st_crawler_wecpsie.crawl_pcpsie_page">
<code class="sig-prename descclassname"><span class="pre">src.st_crawler_wecpsie.</span></code><code class="sig-name descname"><span class="pre">crawl_pcpsie_page</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pcrawler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_crawler_wecpsie.html#crawl_pcpsie_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_crawler_wecpsie.crawl_pcpsie_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigator for the information shown in page: Información Proceso Contratación.</p>
<p>The function handles the navigation and scrapping for the tables Descripción del Proceso de Contratación and Fechas de Control del Proceso.</p>
<p>pcrawler : webdriver instance to perform crawling operations.</p>
<p>Every Proceso de Contratación Pública Subasta Inversa Electronica (PCPSIE) published has this information page.</p>
<p>This function does not depend on any user to make any input, since it retrieves the links for each page
directly from the database. The links to every PCPSIE page are saved to the database during the swing_index_pages
function.</p>
<p>Any error, warning encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crawl_pcpsie_pages</span><span class="p">(</span><span class="n">pcrawler</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="src.st_crawler_wecpsie.swing_index_pages">
<code class="sig-prename descclassname"><span class="pre">src.st_crawler_wecpsie.</span></code><code class="sig-name descname"><span class="pre">swing_index_pages</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_crawler_wecpsie.html#swing_index_pages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_crawler_wecpsie.swing_index_pages" title="Permalink to this definition">¶</a></dt>
<dd><p>Navigator for the search result table in page: Búsqueda de Procesos de Contratación.</p>
<p>The function crawls over the search result table returned after solving the captcha.
It scraps the summary information for each row which represents a published proceso de
contratación pública mediante subasta inversa electronica (PCPSIE).
The search result table in this page shows at least 20 rows per page. The function handles the
navigation across all these pages until it reaches the last page, which means it has
scrapped all the indexed rows information.</p>
<p>driver : webdriver instance to perform crawling operations.</p>
<p>This function opens a web browser window showing the Búsqueda de Procesos de Contratación web page.
Wecpsie version <code class="docutils literal notranslate"><span class="pre">0.0.1</span></code> does not have a captcha solving utility, so this function provides the user
a 12 second-window to solve the captcha before performing any action.</p>
<p>If the captcha is not solved correctly, the window will close terminating the function and the program.</p>
<p>The function first queries the database to determine if it has to run a full insert of all the records
(empty database) or if it has to run the update fucntionality as well as the adding of new records indexed.</p>
<p>Any error, warning encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">swing_index_pages</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-src.st_scraper_wecpsie">
<span id="extract-wecpsie-scraper"></span><h1>Extract-Wecpsie scraper<a class="headerlink" href="#module-src.st_scraper_wecpsie" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="src.st_scraper_wecpsie.extract_SIE_lv1">
<code class="sig-prename descclassname"><span class="pre">src.st_scraper_wecpsie.</span></code><code class="sig-name descname"><span class="pre">extract_SIE_lv1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infotable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_scraper_wecpsie.html#extract_SIE_lv1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_scraper_wecpsie.extract_SIE_lv1" title="Permalink to this definition">¶</a></dt>
<dd><p>Information scraper for tables “Descripción del Proceso de Contratación” and “Fechas de Control” in:
Información Proceso Contratacion. This function is classified as Level_1.</p>
<dl class="simple">
<dt>infotable<span class="classifier">WebObjectInstance</span></dt><dd><p>Web object that represents the table on which all the
information in this page is displayed, including all visible sections.</p>
</dd>
</dl>
<dl>
<dt>info_SIE_dict<span class="classifier">dict,</span></dt><dd><p>A dictionary containing the information scrapped from the two table mentioned.
The dictionary has the following example structure:</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>‘Entidad’:’Enti’,
‘Objeto’:’Desc1’,
‘Código’:’SIE-MREMH-001-2021’,
‘Compra’:’tipo1’,
‘presupuesto’:’Pres’,
‘Tipo’:’Estatus’,
‘Plazo’:’Estatus’,
‘Funcionario:’Funci’,
‘Estado’:’Estatus’,
‘Fecha_publicacion’2021-10-10 13:00:00’,
‘Fecha_puja’2021-10-10 13:00:00’,
‘Fecha_adjudicacion’2021-10-10 13:00:00’
‘Invitacion: https://link/invitaciones’,
‘Contrato: https://link/contrato}</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>autoridades_list<span class="classifier">list,</span></dt><dd><p>A list containing various dictionaries each one with the information scrapped from the table Autoridades.
Each dictionary has the following example structure:</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>‘Cedula’:’172568566’,
‘Nombre’:’Nombre’,
‘Cargo’:’Autoridad’,
‘Origen’:’Nacional’}</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>comision_list<span class="classifier">list,</span></dt><dd><p>A list containing various dictionaries each one with the information scrapped from the table Comision Tecnica if exist.
Each dictionary has the following example structure:</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>‘Cedula’:’1726859645’,
‘Nombre’:’Nombre’,
‘Funcion’:’Gerente’}</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
<p>Please refer to the documentation and implementation of the function <em>save_SIE_info</em> in the database module
to see which fields the dictionary might not contain.</p>
<p>Any error, warning, info encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">st_scraper_wecpsie</span> <span class="k">as</span> <span class="nn">dextract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infotable</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">pcrawler</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;ladoDer&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sie_dict</span><span class="p">,</span><span class="n">list_autoridades</span><span class="p">,</span> <span class="n">list_comision</span> <span class="o">=</span> <span class="n">dextract</span><span class="o">.</span><span class="n">extract_SIE_lv1</span><span class="p">(</span><span class="n">infotable</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="src.st_scraper_wecpsie.extract_SIE_lv2">
<code class="sig-prename descclassname"><span class="pre">src.st_scraper_wecpsie.</span></code><code class="sig-name descname"><span class="pre">extract_SIE_lv2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infotable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_scraper_wecpsie.html#extract_SIE_lv2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_scraper_wecpsie.extract_SIE_lv2" title="Permalink to this definition">¶</a></dt>
<dd><p>Information scraper for table “Informacion de Adjudicacion”
This function is classified as Level_2.</p>
<dl class="simple">
<dt>infotable<span class="classifier">WebObjectInstance</span></dt><dd><p>Web object that represents the table on which all the
information in this page is displayed, including all visible sections.</p>
</dd>
</dl>
<dl>
<dt>contrato_DIC<span class="classifier">dict,</span></dt><dd><p>A dictionary containing the information scrapped from the table mentioned.
The dictionary has the following example structure:</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>‘Ruc’:’172689256001’,
‘Nombre adjudicacion’:’Nombre’,
‘Fecha adjudicacion’:’2020-06-20’,
‘Monto’:’62.03’,
‘Administrador’:’Nombre’
}</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
<p>Please refer to the documentation and implementation of the function <em>save_SIE_contrato_info</em> in the database module
to see which fields the dictionary might not contain.
Any error, warning, info encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">st_scraper_wecpsie</span> <span class="k">as</span> <span class="nn">dextract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infotable</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">pcrawler</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;frminfoGeneralContrato&quot;]/table&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contratos_dict</span> <span class="o">=</span> <span class="n">dextract</span><span class="o">.</span><span class="n">extract_SIE_lv2</span><span class="p">(</span><span class="n">infotable</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="src.st_scraper_wecpsie.extract_SIE_lv2_inv">
<code class="sig-prename descclassname"><span class="pre">src.st_scraper_wecpsie.</span></code><code class="sig-name descname"><span class="pre">extract_SIE_lv2_inv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infotable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcrawler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_scraper_wecpsie.html#extract_SIE_lv2_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_scraper_wecpsie.extract_SIE_lv2_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Information scraper for table “Invitaciones a proveedores”
This function is classified as Level_2.</p>
<dl class="simple">
<dt>infotable<span class="classifier">WebObjectInstance</span></dt><dd><p>Web object that represents the table on which all the
information in this page is displayed, including all visible sections.</p>
</dd>
</dl>
<p>dcrawler : webdriver instance to perform crawling operations.</p>
<dl class="simple">
<dt>n_inv: int, default=”50”</dt><dd><p>The number of rows to retrieve from the current page search table. The crawler module
passes this argument in order to retrieve a certain number of records in the table.</p>
</dd>
</dl>
<blockquote>
<div><dl>
<dt>swing_table_invitation_list<span class="classifier">list,</span></dt><dd><p>A list containing various dictionarys with the information scrapped from the table mentioned.
Each dictionary has the following example structure:</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>‘Razon_social’:’ABAD PARDO REYNALDO CESAR’,
‘Fecha_invitacion’:’2020-07-31 13:02’,
‘Provincia’:’GUAYAS - SIMON BOLIVAR’,
‘Estado’:’ No Habilitado en RUP’
}</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p>Any error, warning, info encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">st_scraper_wecpsie</span> <span class="k">as</span> <span class="nn">dextract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infotable</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">pcrawler</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;formPaginas&quot;]/table&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invitaciones_dict</span> <span class="o">=</span> <span class="n">dextract</span><span class="o">.</span><span class="n">extract_SIE_lv2_inv</span><span class="p">(</span><span class="n">infotable</span><span class="p">,</span><span class="n">pcrawler</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="src.st_scraper_wecpsie.get_main_page_table_info">
<code class="sig-prename descclassname"><span class="pre">src.st_scraper_wecpsie.</span></code><code class="sig-name descname"><span class="pre">get_main_page_table_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dcrawler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_retrieve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_scraper_wecpsie.html#get_main_page_table_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_scraper_wecpsie.get_main_page_table_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Information scraper for search result index table in: Búsqueda de Procesos de Contratación.
This function is classified as Level_Index.</p>
<p>dcrawler : webdriver instance to perform crawling operations.</p>
<dl class="simple">
<dt>n_retrieve<span class="classifier">int, default=”20”</span></dt><dd><p>The number of rows to retrieve from the current page search table. The update module
passes this argument in order to retrieve a certain number of records (&lt;20) in the table.
The spider module uses the default argument since its goal is to retrieve all the records.</p>
</dd>
</dl>
<dl>
<dt>swing_table_process_list<span class="classifier">list,</span></dt><dd><p>A list containing the information scrapped from the n_retrieve records in the current page.
Every element in the list is a dictionary that represents a PCPSIE indexed.
The dictionary has the following example structure:</p>
<blockquote>
<div><dl class="simple">
<dt>{‘Código’: ‘GGE-CJU-2020-020’</dt><dd><p>‘Link’: ‘<a class="reference external" href="https://link-to-PSIE">https://link-to-PSIE</a>’,
‘Entidad Contratante’: ‘Entidad1’,
‘Objeto del proceso’: ‘Desc1’,
‘Estado del proceso’: ‘Est1’,
‘Provincia/Cantón’: ‘Guayas/Guayaquil’,
‘Presupuesto Referencial’: ‘$66,340.00’,
‘Fecha de Publicación’: ‘2020-10-10 13:00:00’,
‘Opciones’: ‘Opc1’}</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>current_last_element<span class="classifier">int,</span></dt><dd><p>The last element scrapped from the search result table. This number is found from the
TABLE “Procesos del 1 al 20 de 870” at the bottom of the page.</p>
</dd>
<dt>last_element<span class="classifier">int,</span></dt><dd><p>The last element (PCPSIE) from the search result table. This number is found from the
TABLE “Procesos del 1 al 20 de 870” at the bottom of the page.</p>
</dd>
</dl>
<p>Any error, warning, info encountered during the function operations will be logged in WECPSIE database.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dcrawler</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">Driver_PATH</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">search_table_dict</span><span class="p">,</span> <span class="n">current_last_element</span><span class="p">,</span> <span class="n">last_element</span> <span class="o">=</span> <span class="n">get_main_page_table_info</span><span class="p">(</span><span class="n">dcrawler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">search_table_dict</span><span class="p">,</span> <span class="n">current_last_element</span><span class="p">,</span> <span class="n">last_element</span> <span class="o">=</span> <span class="n">get_main_page_table_info</span><span class="p">(</span><span class="n">dcrawler</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-src.st_wpse_db_connection">
<span id="store-wecpsie-database"></span><h1>Store-Wecpsie database<a class="headerlink" href="#module-src.st_wpse_db_connection" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="src.st_wpse_db_connection.add_entry_log">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">add_entry_log</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_proceso</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entidad_contratante</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_publicacion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#add_entry_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.add_entry_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts <a href="#id1"><span class="problematic" id="id2">``</span></a>LOG``entries related to any error, warning, info occurred during the execution of the
modules in this project.</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<dl class="simple">
<dt>id_proceso<span class="classifier">str,</span></dt><dd><p>A string representing the id of a PSIE.</p>
</dd>
<dt>entidad_contratante<span class="classifier">str,</span></dt><dd><p>A string representing the entidad contratante of a PSIE.</p>
</dd>
<dt>f_publicacion<span class="classifier">str,</span></dt><dd><p>A string representing the date when a PSIE was published some cases is empty.</p>
</dd>
</dl>
<p>entry_type : str, A string that describes the type of log entry: error, warning, info</p>
<p>level : str, A string that describes the level where this log_entry was called.</p>
<p>action : str, A string that describes the action that fired the log_entry, for example: navigation, extraction, update, store</p>
<dl class="simple">
<dt>entry_message<span class="classifier">str, default=”None”</span></dt><dd><p>A string that represents the message thrown by the system about the error or warning encountered.</p>
</dd>
</dl>
<p>This function also stores the <code class="docutils literal notranslate"><span class="pre">DATETIME</span></code> of the log entry in the database.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.conect_to_wpsie_db">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">conect_to_wpsie_db</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">credentials</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#conect_to_wpsie_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.conect_to_wpsie_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates conection with WECPSIE database.</p>
<p>credentials : list, A list that contains the credentials needed to connect to the database.
Must have: <code class="docutils literal notranslate"><span class="pre">[host,</span> <span class="pre">database_name,</span> <span class="pre">user,</span> <span class="pre">password]</span></code></p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.disconnect_db">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">disconnect_db</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#disconnect_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.disconnect_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconects from WECPSIE database.</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.get_contrato_links">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">get_contrato_links</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#get_contrato_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.get_contrato_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the links of contract if exist and the id for all the stored PCPSIE  in database, ordered by latest date.</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<p>p_links : list, A list of tuples containing the id and the link from the fetched records in database.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.get_invitacion_links">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">get_invitacion_links</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#get_invitacion_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.get_invitacion_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the links of invitation page if exist and the id for all the stored PCPSIE  in database, ordered by latest date.</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<p>p_links : list, A list of tuples containing the id and the link from the fetched records in database.</p>
<p>All processes have a link to the invitations page but in some cases there are no companies invited to the process.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.get_procesos_page_links">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">get_procesos_page_links</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#get_procesos_page_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.get_procesos_page_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the links and the id for all the stored PCPSIE in database, ordered by latest date.</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<p>p_links : list, A list of tuples containing the id and the link from the fetched records in database.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.get_triad_pks">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">get_triad_pks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#get_triad_pks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.get_triad_pks" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a tuple list (id_proceso, entidad_contratante) of the primary
keys used in the tables index_search_results, and info_sie.</p>
<dl class="simple">
<dt>table<span class="classifier">str,</span></dt><dd><p>A string representing the table from which the method will extract the pks.</p>
</dd>
</dl>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<dl class="simple">
<dt>triad_pks<span class="classifier">list,</span></dt><dd><p>A list of tuples which that represents the PK combination for every entry in the selected table.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.save_SIE_info">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">save_SIE_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sie_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_autoridades</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_comision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'insert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#save_SIE_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.save_SIE_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the INSERT/UPDATE transaction for the information scraped from: Información Proceso Contratación.
This includes the information under the tables “Descripción del Proceso de Contratación” and “Fechas de Control del Proceso”</p>
<p>sie_dict : dict, A dictionary containing the information scrapped from the tables “Información Proceso Contratación” and “Fechas de Control.”
list_autoridades : list, A list containing the dictionaries with the information of the Autorities of each process
list_comision : list, A list containing the dictionaries with the information of the Comision Tecnica if the case of each process</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<p>The only mandatory keys in sie_dict are <code class="docutils literal notranslate"><span class="pre">['Codigo','Entidad</span> <span class="pre">Contratante']</span></code>.
The rest of the keys in the dictionary could not exist. It depends on what information is displayed on the page:
Información Proceso Contratación.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.save_contract_SIE_info">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">save_contract_SIE_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proceso_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entidad_contratante</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrato_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'insert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#save_contract_SIE_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.save_contract_SIE_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the INSERT/UPDATE transaction for the information scraped from: Resumen Información Esencial del Contrato.
This includes the information under the tables “Información de Adjudicación” and “Información del Contrato”</p>
<p>proceso_id : str, The identification code of the process
entidad_contratante : str, The entity of the process
contrato_dic : dict, A dictionary containing the information scrapped from the tables “Información de Adjudicación” and “Información del Contrato”</p>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.save_index_search_table">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">save_index_search_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_table_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'insert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#save_index_search_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.save_index_search_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the INSERT/UPDATE transaction for the information scraped from: Búsqueda de Procesos de Contratación.</p>
<dl class="simple">
<dt>search_table_list<span class="classifier">list,</span></dt><dd><p>A list containing the dictionaries that represent the information scrapped from the records in the current page.
Please refer to the method <em>get_main_page_table_info</em> in the extract module for the dictionary structure.</p>
</dd>
</dl>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
<dl class="simple">
<dt>mode<span class="classifier">str, default=’insert’,</span></dt><dd><p>A string that represents the mode this function is going to store the data into database (insert, update)</p>
</dd>
</dl>
<p>Any error, warning, info encountered during the function operations will be logged in WECPSIE database.</p>
</dd></dl>

<dl class="py function">
<dt id="src.st_wpse_db_connection.save_invitation_SIE_info">
<code class="sig-prename descclassname"><span class="pre">src.st_wpse_db_connection.</span></code><code class="sig-name descname"><span class="pre">save_invitation_SIE_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proceso_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entidad_contratante</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invitacion_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'insert'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/st_wpse_db_connection.html#save_invitation_SIE_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.st_wpse_db_connection.save_invitation_SIE_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the INSERT/UPDATE transaction for the information scraped from: Invitacion a proveedores.</p>
<p>proceso_id : str, The identification code of the process
entidad_contratante : str, The entity of the process
invitacion_list : list, A list containing various dictionarys each one with the information scrapped from the table</p>
<blockquote>
<div><p>“Invitacion a proveedores”</p>
</div></blockquote>
<p>connection : CMySQLConnection | MySQLConnection, Connection object to perform further db transactions.</p>
</dd></dl>

</div>
<div class="section" id="module-src.d_utilities">
<span id="utilities-wecpsie"></span><h1>Utilities-Wecpsie<a class="headerlink" href="#module-src.d_utilities" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Sebastian Taraguay.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>